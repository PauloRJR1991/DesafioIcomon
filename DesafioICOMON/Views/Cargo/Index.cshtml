@model List<DesafioICOMON.Models.Cargo>

@using System.ComponentModel.DataAnnotations
@using System.Reflection

@functions {
  string GetDisplayName(Enum value)
  {
    var field = value.GetType().GetField(value.ToString());
    var attribute = field.GetCustomAttribute<DisplayAttribute>();
    return attribute?.Name ?? value.ToString();
  }
}

<h2>Cargos</h2>

<!-- Formulário de busca -->
<form asp-action="Index" method="get" class="mb-3">
    <div class="input-group">
        <input type="text" name="searchString" value="@ViewBag.CurrentFilter" class="form-control" placeholder="Buscar por nome..." />
        <button type="submit" class="btn btn-primary">Buscar</button>
    </div>
</form>

<!-- Botão de novo cargo -->
<a asp-action="Create" class="btn btn-primary">Novo Cargo</a>

<table class="table mt-3">
  <thead>
    <tr>
      <th>ID</th>
      <th>Nome</th>
      <th>Nível</th>
      <th>Ativo</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    @foreach (var cargo in Model)
    {
      var statusEnum = Enum.Parse<NivelCargo>(cargo.Nivel);
      <tr>
        <td>@cargo.Id</td>
        <td>@cargo.Nome</td>
        <td>@GetDisplayName(statusEnum)</td>
        <td>@(cargo.Ativo == true ? "1-Sim" : "0-Não")</td>
        <td>
          <a asp-action="Edit" asp-route-id="@cargo.Id" class="btn btn-warning">Editar</a>
          <a asp-action="Delete" asp-route-id="@cargo.Id" class="btn btn-danger">Excluir</a>
        </td>
      </tr>
    }
  </tbody>
</table>

